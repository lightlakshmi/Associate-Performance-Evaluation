<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vyastics - Employee Evaluation System</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/react/18.2.0/umd/react.production.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/18.2.0/umd/react-dom.production.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/babel-standalone/7.23.5/babel.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .company-logo {
            height: 50px;
            width: auto;
        }
        @media (max-width: 640px) {
            .company-logo {
                height: 40px;
            }
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        // Vyastics logo as base64
        const COMPANY_LOGO = "data:image/jpeg;base64,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";

        const evaluationCategories = {
            "Time Management & Productivity": [
                "Overall Effectiveness",
                "Task Prioritization",
                "Completion Ahead of Schedule",
                "Handling Distractions"
            ],
            "Adaptability & Learning": [
                "Adapting to Challenges",
                "Learning New Skills Quickly",
                "Response to Changes",
                "Openness to Feedback"
            ],
            "Initiative & Proactivity": [
                "Taking Initiative",
                "Identifying Opportunities",
                "Impact of Initiatives",
                "Motivation for Additional Responsibilities"
            ],
            "Quality of Work": [
                "Consistency in Quality",
                "Attention to Detail",
                "Meeting Quality Standards",
                "Responsiveness to Feedback"
            ],
            "Attitude & Professionalism": [
                "Overall Attitude",
                "Professionalism and Conduct",
                "Contribution to Positive Environment",
                "Handling Conflicts"
            ],
            "Reliability & Accountability": [
                "Punctuality",
                "Meeting Deadlines",
                "Dependability in Critical Situations"
            ],
            "Teamwork & Collaboration": [
                "Collaboration Effectiveness",
                "Working Well with Others",
                "Contributions to Team",
                "Resolving Differences"
            ]
        };

        const employees = [
            "Krishnaveni", "Dhiya", "Moorthy", "Sundar", "Anuragh",
            "Aditya", "Divya", "Christina", "Poornima", "Vishva"
        ];

        const managers = ["Naanci", "Sri", "Lakshmi"];

        function ManagerEvaluationSystem() {
            const [currentManager, setCurrentManager] = useState("");
            const [currentEmployee, setCurrentEmployee] = useState("");
            const [evaluations, setEvaluations] = useState({});
            const [showSuccess, setShowSuccess] = useState(false);
            const [loading, setLoading] = useState(true);
            const [saveStatus, setSaveStatus] = useState("");

            useEffect(() => {
                loadAllData();
            }, []);

            const loadAllData = async () => {
                setLoading(true);
                const initEvals = {};
                
                for (const manager of managers) {
                    initEvals[manager] = {};
                    
                    for (const employee of employees) {
                        initEvals[manager][employee] = {};
                        
                        try {
                            const storageKey = `eval:${manager}:${employee}`;
                            const result = await window.storage.get(storageKey, true);
                            
                            if (result && result.value) {
                                initEvals[manager][employee] = JSON.parse(result.value);
                            } else {
                                Object.values(evaluationCategories).flat().forEach(criterion => {
                                    initEvals[manager][employee][criterion] = 0;
                                });
                            }
                        } catch (error) {
                            Object.values(evaluationCategories).flat().forEach(criterion => {
                                initEvals[manager][employee][criterion] = 0;
                            });
                        }
                    }
                }
                
                setEvaluations(initEvals);
                setLoading(false);
            };

            const handleRatingChange = (criterion, rating) => {
                if (!currentManager || !currentEmployee) return;
                
                setEvaluations(prev => ({
                    ...prev,
                    [currentManager]: {
                        ...prev[currentManager],
                        [currentEmployee]: {
                            ...prev[currentManager][currentEmployee],
                            [criterion]: rating
                        }
                    }
                }));
            };

            const saveEvaluation = async () => {
                setSaveStatus("saving");
                
                try {
                    const storageKey = `eval:${currentManager}:${currentEmployee}`;
                    const data = evaluations[currentManager][currentEmployee];
                    await window.storage.set(storageKey, JSON.stringify(data), true);
                    
                    setSaveStatus("success");
                    setShowSuccess(true);
                    setTimeout(() => {
                        setShowSuccess(false);
                        setSaveStatus("");
                    }, 3000);
                    
                    const currentIndex = employees.indexOf(currentEmployee);
                    if (currentIndex < employees.length - 1) {
                        setCurrentEmployee(employees[currentIndex + 1]);
                    } else {
                        setCurrentEmployee("");
                    }
                } catch (error) {
                    setSaveStatus("error");
                    alert("Error saving evaluation. Please try again.");
                }
            };

            const exportToExcel = () => {
                const wb = XLSX.utils.book_new();

                managers.forEach(manager => {
                    const data = [];
                    
                    const headers = ["Manager Name", "Employee Name", ...Object.values(evaluationCategories).flat()];
                    data.push(headers);

                    employees.forEach(employee => {
                        const row = [
                            manager,
                            employee,
                            ...Object.values(evaluationCategories).flat().map(criterion => 
                                evaluations[manager]?.[employee]?.[criterion] || 0
                            )
                        ];
                        data.push(row);
                    });

                    const ws = XLSX.utils.aoa_to_sheet(data);
                    const colWidths = [{ wch: 15 }, { wch: 15 }, ...Array(headers.length - 2).fill({ wch: 12 })];
                    ws['!cols'] = colWidths;

                    XLSX.utils.book_append_sheet(wb, ws, manager);
                });

                XLSX.writeFile(wb, "Vyastics_Manager_Evaluations.xlsx");
            };

            const exportManagerData = (manager) => {
                const wb = XLSX.utils.book_new();
                const data = [];
                
                const headers = ["Manager Name", "Employee Name", ...Object.values(evaluationCategories).flat()];
                data.push(headers);

                employees.forEach(employee => {
                    const row = [
                        manager,
                        employee,
                        ...Object.values(evaluationCategories).flat().map(criterion => 
                            evaluations[manager]?.[employee]?.[criterion] || 0
                        )
                    ];
                    data.push(row);
                });

                const ws = XLSX.utils.aoa_to_sheet(data);
                const colWidths = [{ wch: 15 }, { wch: 15 }, ...Array(headers.length - 2).fill({ wch: 12 })];
                ws['!cols'] = colWidths;

                XLSX.utils.book_append_sheet(wb, ws, manager);
                XLSX.writeFile(wb, `Vyastics_${manager}_Evaluations.xlsx`);
            };

            const getCompletionStatus = (manager) => {
                if (!evaluations[manager]) return { completed: 0, total: employees.length };
                
                let completed = 0;
                employees.forEach(employee => {
                    const ratings = Object.values(evaluations[manager][employee] || {});
                    if (ratings.some(r => r > 0)) completed++;
                });
                
                return { completed, total: employees.length };
            };

            const isEmployeeCompleted = (manager, employee) => {
                if (!evaluations[manager]?.[employee]) return false;
                const ratings = Object.values(evaluations[manager][employee]);
                return ratings.every(r => r > 0);
            };

            if (loading) {
                return (
                    <div className="min-h-screen bg-gradient-to-br from-blue-50 via-indigo-50 to-purple-50 flex items-center justify-center">
                        <div className="text-center">
                            <img src={COMPANY_LOGO} alt="Vyastics" className="company-logo mx-auto mb-6" />
                            <div className="w-16 h-16 border-4 border-indigo-600 border-t-transparent rounded-full animate-spin mx-auto mb-4"></div>
                            <p className="text-gray-600 font-semibold">Loading evaluation system...</p>
                        </div>
                    </div>
                );
            }

            return (
                <div className="min-h-screen bg-gradient-to-br from-blue-50 via-indigo-50 to-purple-50">
                    <div className="bg-white shadow-md border-b border-gray-200">
                        <div className="max-w-7xl mx-auto px-4 sm:px-6 py-4">
                            <div className="flex items-center justify-between flex-wrap gap-4">
                                <div className="flex items-center gap-4">
                                    <img src={COMPANY_LOGO} alt="Vyastics" className="company-logo" />
                                    <div>
                                        <h1 className="text-2xl sm:text-3xl font-bold text-gray-900">Employee Evaluation System</h1>
                                        <p className="text-xs sm:text-sm text-gray-600 mt-1">Performance Assessment Portal • Confidential</p>
                                    </div>
                                </div>
                                <button
                                    onClick={exportToExcel}
                                    className="px-4 sm:px-6 py-2 sm:py-3 bg-green-600 text-white rounded-lg hover:bg-green-700 transition shadow-md font-semibold flex items-center gap-2 text-sm sm:text-base"
                                >
                                    <svg className="w-4 h-4 sm:w-5 sm:h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
                                    </svg>
                                    <span className="hidden sm:inline">Download All Data</span>
                                    <span className="sm:hidden">Download</span>
                                </button>
                            </div>
                        </div>
                    </div>

                    <div className="max-w-7xl mx-auto px-4 sm:px-6 py-6 sm:py-8">
                        {!currentManager && (
                            <div className="space-y-6">
                                <div className="bg-blue-50 border-l-4 border-blue-500 p-4 mb-6 rounded">
                                    <div className="flex items-start">
                                        <svg className="w-5 h-5 sm:w-6 sm:h-6 text-blue-500 mr-3 flex-shrink-0 mt-0.5" fill="currentColor" viewBox="0 0 20 20">
                                            <path fillRule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clipRule="evenodd" />
                                        </svg>
                                        <div>
                                            <h3 className="text-blue-800 font-semibold text-sm sm:text-base">Secure Cloud Storage</h3>
                                            <p className="text-blue-700 text-xs sm:text-sm mt-1">All evaluations are securely saved. You can close this page and return anytime to continue.</p>
                                        </div>
                                    </div>
                                </div>

                                <div className="text-center mb-8">
                                    <h2 className="text-xl sm:text-2xl font-bold text-gray-800 mb-2">Select Your Manager Profile</h2>
                                    <p className="text-sm sm:text-base text-gray-600">Choose your name to begin evaluations</p>
                                </div>
                                
                                <div className="grid sm:grid-cols-2 md:grid-cols-3 gap-4 sm:gap-6">
                                    {managers.map(manager => {
                                        const { completed, total } = getCompletionStatus(manager);
                                        const percentage = Math.round((completed / total) * 100);
                                        
                                        return (
                                            <div key={manager} className="bg-white rounded-xl shadow-lg hover:shadow-xl transition p-4 sm:p-6 border border-gray-200">
                                                <div className="flex items-center justify-between mb-4">
                                                    <div className="flex items-center gap-3">
                                                        <div className="w-10 h-10 sm:w-12 sm:h-12 bg-gradient-to-br from-blue-500 to-indigo-600 rounded-full flex items-center justify-center text-white font-bold text-lg sm:text-xl">
                                                            {manager.charAt(0)}
                                                        </div>
                                                        <div>
                                                            <h3 className="text-lg sm:text-xl font-bold text-gray-900">{manager}</h3>
                                                            <p className="text-xs sm:text-sm text-gray-500">Manager</p>
                                                        </div>
                                                    </div>
                                                </div>
                                                
                                                <div className="mb-4">
                                                    <div className="flex justify-between text-xs sm:text-sm mb-2">
                                                        <span className="text-gray-600">Progress</span>
                                                        <span className="font-semibold text-gray-900">{completed}/{total} employees</span>
                                                    </div>
                                                    <div className="w-full bg-gray-200 rounded-full h-2.5">
                                                        <div className="bg-gradient-to-r from-blue-500 to-indigo-600 h-2.5 rounded-full transition-all" style={{ width: `${percentage}%` }}></div>
                                                    </div>
                                                </div>

                                                <div className="space-y-2">
                                                    <button
                                                        onClick={() => setCurrentManager(manager)}
                                                        className="w-full px-4 py-2.5 sm:py-3 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 transition font-semibold text-sm sm:text-base"
                                                    >
                                                        Start Evaluations
                                                    </button>
                                                    <button
                                                        onClick={() => exportManagerData(manager)}
                                                        className="w-full px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition text-xs sm:text-sm"
                                                    >
                                                        Export {manager}'s Data
                                                    </button>
                                                </div>
                                            </div>
                                        );
                                    })}
                                </div>
                            </div>
                        )}

                        {currentManager && !currentEmployee && (
                            <div className="space-y-6">
                                <div className="bg-white rounded-xl shadow-md p-4 sm:p-6 border border-gray-200">
                                    <button
                                        onClick={() => setCurrentManager("")}
                                        className="text-indigo-600 hover:text-indigo-800 font-semibold mb-4 flex items-center gap-2 text-sm sm:text-base"
                                    >
                                        <svg className="w-4 h-4 sm:w-5 sm:h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M15 19l-7-7 7-7" />
                                        </svg>
                                        Back to Manager Selection
                                    </button>
                                    
                                    <h2 className="text-xl sm:text-2xl font-bold text-gray-800 mb-2">Welcome, {currentManager}</h2>
                                    <p className="text-sm sm:text-base text-gray-600 mb-6">Select an employee to evaluate</p>

                                    <div className="grid sm:grid-cols-2 lg:grid-cols-3 gap-3 sm:gap-4">
                                        {employees.map(employee => {
                                            const completed = isEmployeeCompleted(currentManager, employee);
                                            
                                            return (
                                                <button
                                                    key={employee}
                                                    onClick={() => setCurrentEmployee(employee)}
                                                    className={`p-3 sm:p-4 rounded-lg border-2 transition text-left ${
                                                        completed 
                                                            ? 'bg-green-50 border-green-300 hover:border-green-400' 
                                                            : 'bg-white border-gray-200 hover:border-indigo-400'
                                                    }`}
                                                >
                                                    <div className="flex items-center justify-between">
                                                        <div className="flex items-center gap-2 sm:gap-3">
                                                            <div className={`w-8 h-8 sm:w-10 sm:h-10 rounded-full flex items-center justify-center text-white font-semibold text-sm ${
                                                                completed ? 'bg-green-500' : 'bg-gray-400'
                                                            }`}>
                                                                {employee.charAt(0)}
                                                            </div>
                                                            <span className="font-semibold text-gray-900 text-sm sm:text-base">{employee}</span>
                                                        </div>
                                                        {completed && (
                                                            <svg className="w-5 h-5 sm:w-6 sm:h-6 text-green-600 flex-shrink-0" fill="currentColor" viewBox="0 0 20 20">
                                                                <path fillRule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clipRule="evenodd" />
                                                            </svg>
                                                        )}
                                                    </div>
                                                </button>
                                            );
                                        })}
                                    </div>
                                </div>
                            </div>
                        )}

                        {currentManager && currentEmployee && (
                            <div className="space-y-6">
                                <div className="bg-white rounded-xl shadow-md p-4 sm:p-6 border border-gray-200">
                                    <button
                                        onClick={() => setCurrentEmployee("")}
                                        className="text-indigo-600 hover:text-indigo-800 font-semibold mb-4 flex items-center gap-2 text-sm sm:text-base"
                                    >
                                        <svg className="w-4 h-4 sm:w-5 sm:h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M15 19l-7-7 7-7" />
                                        </svg>
                                        Back to Employee List
                                    </button>
                                    
                                    <div className="flex items-center justify-between mb-6 flex-wrap gap-4">
                                        <div>
                                            <h2 className="text-xl sm:text-2xl font-bold text-gray-900">Evaluating: {currentEmployee}</h2>
                                            <p className="text-xs sm:text-sm text-gray-600 mt-1">Manager: {currentManager}</p>
                                        </div>
                                        <div className="px-3 sm:px-4 py-2 bg-blue-100 rounded-lg">
                                            <p className="text-xs sm:text-sm font-semibold text-blue-800">Scale: 1 (Poor) - 5 (Excellent)</p>
                                        </div>
                                    </div>

                                    {showSuccess && (
                                        <div className="mb-6 p-3 sm:p-4 bg-green-100 border border-green-400 rounded-lg flex items-center gap-3">
                                            <svg className="w-5 h-5 sm:w-6 sm:h-6 text-green-600 flex-shrink-0" fill="currentColor" viewBox="0 0 20 20">
                                                <path fillRule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clipRule="evenodd" />
                                            </svg>
                                            <span className="text-green-800 font-semibold text-sm sm:text-base">Saved successfully!</span>
                                        </div>
                                    )}

                                    <div className="space-y-4 sm:space-y-6">
                                        {Object.entries(evaluationCategories).map(([category, criteria]) => (
                                            <div key={category} className="bg-gray-50 rounded-lg p-4 sm:p-6 border border-gray-200">
                                                <h3 className="text-base sm:text-lg font-bold text-gray-900 mb-3 sm:mb-4 flex items-center gap-2">
                                                    <div className="w-1.5 sm:w-2 h-5 sm:h-6 bg-indigo-600 rounded"></div>
                                                    <span className="text-sm sm:text-base">{category}</span>
                                                </h3>
                                                
                                                <div className="space-y-3 sm:space-y-4">
                                                    {criteria.map(criterion => {
                                                        const currentRating = evaluations[currentManager]?.[currentEmployee]?.[criterion] || 0;
                                                        
                                                        return (
                                                            <div key={criterion} className="bg-white p-3 sm:p-4 rounded-lg border border-gray-200">
                                                                <label className="block text-xs sm:text-sm font-semibold text-gray-700 mb-2 sm:mb-3">
                                                                    {criterion}
                                                                </label>
                                                                <div className="flex gap-1.5 sm:gap-2">
                                                                    {[1, 2, 3, 4, 5].map(rating => (
                                                                        <button
                                                                            key={rating}
                                                                            onClick={() => handleRatingChange(criterion, rating)}
                                                                            className={`flex-1 py-2 sm:py-3 px-2 sm:px-4 rounded-lg font-semibold transition text-sm sm:text-base ${
                                                                                currentRating === rating
                                                                                    ? 'bg-indigo-600 text-white shadow-lg scale-105'
                                                                                    : 'bg-gray-100 text-gray-700 hover:bg-gray-200'
                                                                            }`}
                                                                        >
                                                                            {rating}
                                                                        </button>
                                                                    ))}
                                                                </div>
                                                            </div>
                                                        );
                                                    })}
                                                </div>
                                            </div>
                                        ))}
                                    </div>

                                    <div className="mt-6 sm:mt-8 flex gap-3 sm:gap-4 flex-wrap">
                                        <button
                                            onClick={saveEvaluation}
                                            disabled={saveStatus === "saving"}
                                            className="flex-1 min-w-[200px] px-4 sm:px-8 py-3 sm:py-4 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 transition font-bold text-sm sm:text-lg shadow-lg disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2"
                                        >
                                            {saveStatus === "saving" ? (
                                                <>
                                                    <div className="w-4 h-4 sm:w-5 sm:h-5 border-2 border-white border-t-transparent rounded-full animate-spin"></div>
                                                    Saving...
                                                </>
                                            ) : (
                                                <>
                                                    <svg className="w-4 h-4 sm:w-5 sm:h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M5 13l4 4L19 7" />
                                                    </svg>
                                                    Save & Continue
                                                </>
                                            )}
                                        </button>
                                        <button
                                            onClick={() => exportManagerData(currentManager)}
                                            className="px-4 sm:px-8 py-3 sm:py-4 bg-green-600 text-white rounded-lg hover:bg-green-700 transition font-bold shadow-lg flex items-center gap-2 text-sm sm:text-base"
                                        >
                                            <svg className="w-4 h-4 sm:w-5 sm:h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
                                            </svg>
                                            Export
                                        </button>
                                    </div>
                                </div>
                            </div>
                        )}
                    </div>

                    <div className="bg-white border-t border-gray-200 py-4 mt-8">
                        <div className="max-w-7xl mx-auto px-4 sm:px-6 text-center">
                            <p className="text-xs sm:text-sm text-gray-600">
                                © 2025 Vyastics. All evaluations are confidential.
                            </p>
                        </div>
                    </div>
                </div>
            );
        }

        ReactDOM.render(<ManagerEvaluationSystem />, document.getElementById('root'));
    </script>
</body>
</html>